import { StrictMode } from 'react'
import { createRoot } from 'react-dom/client'
import './index.css'
import App from './App.tsx'
import { Provider } from 'react-redux'
import { persistor, store } from './app/store.ts'
import { PersistGate } from 'redux-persist/integration/react'

// –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è persist –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏
window.addEventListener("storage", () => {
  persistor.persist(); // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ persisted state
});

createRoot(document.getElementById('root')!).render(
  <StrictMode>
    <Provider store={store}>
      <PersistGate loading={null} persistor={persistor}>
      <App />
      </PersistGate>
    </Provider>
  </StrictMode>,
)


// npm install redux-persist




// üéì –ß—Ç–æ —Ç–∞–∫–æ–µ <PersistGate>?

// <PersistGate> ‚Äî —ç—Ç–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏–∑ –ø–∞–∫–µ—Ç–∞ redux-persist, –∫–æ—Ç–æ—Ä—ã–π:

// ‚úÖ –ë–ª–æ–∫–∏—Ä—É–µ—Ç —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –≤—Å–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–æ —Ç–µ—Ö –ø–æ—Ä,

// –ø–æ–∫–∞ –¥–∞–Ω–Ω—ã–µ –∏–∑ localStorage (–∏–ª–∏ sessionStorage) –Ω–µ –±—É–¥—É—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤ Redux store.

// üß† –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?

// –ï—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å PersistGate, –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç —Å–ª–µ–¥—É—é—â–µ–µ:

// Redux store –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –±—É–¥–µ—Ç –ø—É—Å—Ç—ã–º.

// –í–∞—à UI –Ω–∞ –º–≥–Ω–æ–≤–µ–Ω–∏–µ –ø–æ–∫–∞–∂–µ—Ç –ø—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ (undefined, –ø—É—Å—Ç—ã–µ —Å–ø–∏—Å–∫–∏ –∏ —Ç. –¥.).

// –¢–æ–ª—å–∫–æ –∑–∞—Ç–µ–º –Ω–∞—á–Ω—ë—Ç—Å—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ localStorage.

// UI –ø–µ—Ä–µ—Ä–∏—Å—É–µ—Ç—Å—è ‚Äî —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ –º–µ—Ä—Ü–∞–Ω–∏–µ, "—Å–∫–ª–µ–∏–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞".

// PersistGate –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —ç—Ç–æ.

// –û–Ω –≥–æ–≤–æ—Ä–∏—Ç:

// ‚Äú–ü–æ–¥–æ–∂–¥–∏, —Å–Ω–∞—á–∞–ª–∞ —è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª—é –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ store,
// –∞ –ø–æ—Ç–æ–º —É–∂–µ –æ—Ç–æ–±—Ä–∞–∂–∞–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ‚Äù.

// –ü–æ—ç—Ç–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—Ä–∞–∑—É —É–≤–∏–¥–∏—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –±–µ–∑ —Å–∫–∞—á–∫–æ–≤.
//========================================

// persistor={persistor}

// persistor ‚Äî —ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç, —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Ç–∞–∫:

// export const persistor = persistStore(store);


// –û–Ω –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞:

// —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ Redux state –≤ localStorage

// –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ Redux state –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

// PersistGate –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –µ–≥–æ, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å:

// –∫–æ–≥–¥–∞ –∫—ç—à –∑–∞–≥—Ä—É–∂–µ–Ω

// –º–æ–∂–Ω–æ –ª–∏ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ



// PersistGate = ‚Äú–¥–≤–µ—Ä—å, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è, –ø–æ–∫–∞ –¥–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã‚Äù.

// –í–æ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

// 1Ô∏è‚É£ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
// 2Ô∏è‚É£ PersistGate –≤–∏–¥–∏—Ç, —á—Ç–æ localStorage –µ—â—ë –Ω–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
// 3Ô∏è‚É£ –í—Ä–µ–º–µ–Ω–Ω–æ —Ä–µ–Ω–¥–µ—Ä–∏—Ç loading (–∏–ª–∏ –Ω–∏—á–µ–≥–æ, –µ—Å–ª–∏ loading={null})
// 4Ô∏è‚É£ –†–µ–∫–∞–≤–µ—Ä–∏—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–∑ localStorage
// 5Ô∏è‚É£ –û—Ç–∫—Ä—ã–≤–∞–µ—Ç ‚Äú–¥–≤–µ—Ä—å‚Äù –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç <App />
// 6Ô∏è‚É£ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–∞–µ—Ç —É–∂–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π state